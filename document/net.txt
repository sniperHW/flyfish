网络输出设计

1 向应用提供一个非阻塞的发送接口

2 应用层使用方便，只管向输出层投递需要发送的数据包即可。封包以及拥塞控制均由输出层处理。


目前存在的问题

pkg/net提供了非阻塞发送接口，通过一个发送队列实现非阻塞发送。发送线程从发送队列提取要发送的包，在发送线程封包执行发送。
拥塞控制是由发送队列来控制的，通过设置发送队列的最大大小，一旦队列超过大小限制就丢弃数据包。

这个处理没能正确处理实际的网络拥塞情况，例如，如果发送线程正在发包，在此瞬间，应用层请求发送超过发送队列大小的一批小包。
这批包总的字节数可能不大，但确因为数量多，在实际上并未发送网络拥塞的情况下执行了丢包。






























